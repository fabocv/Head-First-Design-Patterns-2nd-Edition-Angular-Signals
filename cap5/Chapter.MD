# CapÃ­tulo 5: One-of-a-Kind Objects: the Singleton Pattern

# Singleton Pattern | Creacional

El Singleton asegura que exista una Ãºnica instancia de una clase en toda la aplicaciÃ³n y proporciona un punto global de acceso a ella.

âœ… Pros

- Control Ãºnico de recursos compartidos (DB, logger, cache).

- Menos memoria: no se crean mÃºltiples instancias innecesarias.

- FÃ¡cil acceso: cualquier parte del sistema puede usarlo sin pasarlo como dependencia.

- Consistencia global: todos usan el mismo estado.

âŒ Contras

- Acoplamiento oculto: partes del cÃ³digo dependen del mismo estado global.

- DifÃ­cil de testear: los tests pueden contaminarse si la instancia mantiene estado.

- ViolaciÃ³n de SRP: a veces combina demasiadas responsabilidades.

- Riesgo de abuso: se usa como â€œatajoâ€ en lugar de aplicar inyecciÃ³n de dependencias.

### Ejemplos empresariales + Pasos de implementaciÃ³n
#### 1. Gestor de configuraciÃ³n (config service en empresa SaaS)

Problema: mÃºltiples microservicios necesitan leer la misma configuraciÃ³n (APIs, endpoints, tokens).

Pasos:

- Crear clase ConfigManager que cargue la configuraciÃ³n al iniciar.

- Definir punto global de acceso Ãºnico (singleton).

- Asegurar que el resto de servicios usen ConfigManager.getInstance().

- Prevenir duplicados cargando config solo una vez.

#### 2. Logger centralizado

Problema: distintos mÃ³dulos generan logs (errores, auditorÃ­a). Se necesita consistencia en formato y destino.

Pasos:

- Crear clase Logger que maneje salida a archivo/DB/monitoring.

- Exponer Ãºnica instancia compartida.

- Asegurar thread-safety si hay concurrencia.

- Usar Logger.getInstance().log(...) en todos los mÃ³dulos.

#### 3. Pool de conexiones a base de datos

Problema: se debe evitar que cada servicio cree conexiones ilimitadas.

Pasos:

- Crear clase DBConnectionPool que administre las conexiones.

- Limitar la cantidad mÃ¡xima de conexiones en la instancia Ãºnica.

- Proveer mÃ©todos getConnection() / releaseConnection().

- Asegurar que toda la app use esa instancia Ãºnica para interactuar con DB.

4. GestiÃ³n de cache en sistema financiero

Problema: varias operaciones requieren acceso a datos rÃ¡pidos (ej. tasas de cambio, catÃ¡logos).

Pasos:

- Crear clase CacheService que maneje almacenamiento en memoria.

- Implementar polÃ­tica de expiraciÃ³n de datos.

- Garantizar Ãºnica instancia para evitar duplicados inconsistentes.

- Consultar el cache antes de acceder a DB o API externa.

#### 5. Control de sesiones de usuario en aplicaciÃ³n web

Problema: en un portal empresarial, se necesita un servicio Ãºnico que gestione las sesiones activas.

Pasos:

- Crear clase SessionManager que registre usuarios activos.

- Implementar mÃ©todos para crear, validar y destruir sesiones.

- Mantener la instancia Ãºnica durante todo el ciclo de la app.

- Asegurar acceso concurrente seguro para mÃºltiples usuarios.

> ### ðŸ“Œ Regla de oro:
>
>El Singleton no es un martillo para todo. Ãšsalo solo cuando exista un recurso Ãºnico y centralizado en la empresa (config, cache, logger, pool de conexiones).